# Microsoft 365 Exchange Integration Configuration
# Compatible with Node.js 24.6.0+

# =============================================================================
# MICROSOFT AZURE APP REGISTRATION
# =============================================================================
# Get these values from your Azure App Registration
MICROSOFT_CLIENT_ID=your_microsoft_app_client_id
MICROSOFT_CLIENT_SECRET=your_microsoft_app_client_secret
MICROSOFT_TENANT_ID=your_directory_tenant_id

# =============================================================================
# EXCHANGE OAUTH CONFIGURATION
# =============================================================================
# Production
EXCHANGE_OAUTH_REDIRECT_URI=https://saruman.smartservices.tech/admin/exchange/callback

# DEV - Development
# EXCHANGE_OAUTH_REDIRECT_URI=http://localhost:3000/admin/exchange/callback

EXCHANGE_OAUTH_SCOPES=https://graph.microsoft.com/Mail.Read,https://graph.microsoft.com/Mail.Send,https://graph.microsoft.com/User.Read

# =============================================================================
# EMAIL PROVIDER CONFIGURATION
# =============================================================================
# Options: 'smtp' or 'exchange'
EMAIL_PROVIDER=exchange

# Exchange Email Configuration (used when EMAIL_PROVIDER=exchange)
EXCHANGE_FROM_NAME=Support Team
EXCHANGE_FROM_EMAIL=support@yourdomain.com

# Optional: Reply-To address (useful for distribution groups)
# Set this to show a different reply address than the sending account
# Example: EXCHANGE_FROM_EMAIL=tickets@company.com, EXCHANGE_REPLY_TO_EMAIL=support@company.com
EXCHANGE_REPLY_TO_EMAIL=support@yourdomain.com

# =============================================================================
# EXCHANGE EMAIL PROCESSING
# =============================================================================
EXCHANGE_EMAIL_BATCH_SIZE=50
EXCHANGE_EMAIL_POLL_INTERVAL=300000

# =============================================================================
# EXCHANGE RATE LIMITING
# =============================================================================
EXCHANGE_RATE_LIMIT=100

# =============================================================================
# EXCHANGE SECURITY CONFIGURATION
# =============================================================================
# Production settings
EXCHANGE_COOKIE_SECURE=true
EXCHANGE_COOKIE_HTTPONLY=true
EXCHANGE_COOKIE_SAMESITE=strict

# DEV - Development settings
# EXCHANGE_COOKIE_SECURE=false
# EXCHANGE_COOKIE_HTTPONLY=true
# EXCHANGE_COOKIE_SAMESITE=lax

# =============================================================================
# OPTIONAL EXCHANGE SETTINGS
# =============================================================================
# Custom domain for OAuth redirect
# EXCHANGE_CUSTOM_DOMAIN=yourdomain.com
